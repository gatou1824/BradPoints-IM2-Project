<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Reports & Feedback - Admin</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="../adminStyles.css">
    </head>
    <body>
        <!-- INSERT_YOUR_REWRITE_HERE -->
                        <div style="display: flex; justify-content: center; margin-top: 20px;" id="nav-tabs">
                            <div class="tab-buttons">
                                <a href="../adminDashboard.html"><button>Home</button></a>
                                <a href="../users.html"><button class="active">Users</button></a>
                                <a href="../feedbacks.html"><button>Feedbacks</button></a>
                                <a href="../rewards.html"><button>Incentives</button></a>
                            </div>
                        </div>

                    <div id="customerSection">
                        <div class="d-flex justify-content-between align-items-center mb-6">
                            <h2>Customer Management</h2>
                            <!-- <button class="btn btn-primary custom-red-card" data-toggle="modal" data-target="#addCustomerModal">Add Customer</button> -->
                        </div>

                        <div class="text-right mb-3">
                            <button class="btn btn-outline-secondary" 
                            id="allCustomers" onclick="allCustomers()">See All</button>
                        </div>

                        <table class="table table-hover">
                            <thead class="thread-red">
                                <tr>
                                    <th>id</th>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Points</th>
                                    <th>Password</th>
                                    <th>Verified</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="customerList">
                                
                            </tbody>
                        </table>
                    </div> 

                    <!-- staff management -->
                    <div id="staffSection">
                        <div class="d-flex justify-content-between align-items-center mb-6 mt-5">
                            <h2>Staff Management</h2>
                            <!-- <button class="btn btn-primary custom-red-card" data-toggle="modal" data-target="#addCustomerModal">Add Staff</button> -->
                        </div>

                        <div class="text-right mb-3">
                            <button class="btn btn-outline-secondary" 
                            id="allStaff" onclick="allStaff()">See All</button>
                        </div>

                        <table class="table table-hover">
                            <thead class="thread-red">
                                <tr>
                                    <th>id</th>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="staffList">
                                
                            </tbody>
                        </table>
                    </div> 


                <div id="adminSection">
                        <div class="d-flex justify-content-between align-items-center mb-6 mt-5">
                            <h2>Admin Management</h2>
                            <!-- <button class="btn btn-primary custom-red-card" data-toggle="modal" data-target="#addCustomerModal">Add Staff</button> -->
                        </div>

                        <div class="text-right mb-3">
                            <button class="btn btn-outline-secondary" 
                            id="allAdmin" onclick="allAdmin()">See All</button>
                        </div>

                        <table class="table table-hover">
                            <thead class="thread-red">
                                <tr>
                                    <th>id</th>
                                    <th>Username</th>
                                    <th>Email</th>
                                </tr>
                            </thead>
                            <tbody id="adminList">
                                
                            </tbody>
                        </table>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-12">
                            <div class="quick-actions">
                                <h3>Quick Actions</h3>
                                <button class="btn btn-secondary" onclick="location.href='feedbacks.html'">View Latest Feedback</button>
                                <button class="btn btn-success" onclick="location.href='rewards.html'">Add New Reward</button>
                            </div>
                        </div>
                    </div>

                    <!-- admin management -->


    <!-- MODALS BELOW -->
        <!-- ADD CUSTOMER -->
        <div class="modal fade" id="addCustomerModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Add New Customer</h5>
                        <button type="button" class="close" data-dismiss="modal">
                            <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="text" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Phone</label>
                                <input type="text" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Points</label>
                                <input type="number" class="form-control" required>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-success">Save Reward</button>
                    </div>
                </div>
            </div>
        </div>
    
        <!-- DELETE CUSTOMER -->

        <div class="modal fade" id="deleteCustomerModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">Confirm Delete</h5>
                    <button type="button" class="close text-white" data-dismiss="modal">
                    <span>&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p id="deleteCustomerText">Are you sure you want to delete this customer?</p>
                    <input type="hidden" id="deleteCustomerId">
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                </div>
                </div>
            </div>
        </div>



        <!-- EDIT CUSTOMER -->
            <div class="modal fade" id="editCustomerModal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Edit Customer</h5>
                        <button type="button" class="close" data-dismiss="modal">
                        <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="editCustomerForm">
                        <input type="hidden" id="customerIdField">
                        <div class="form-group">
                            <label>Customer's Full Name</label>
                            <input type="text" class="form-control" id="editCustomerName">
                        </div>
                        <div class="form-group">
                            <label>Customer's Email</label>
                            <input type="number" class="form-control" id="editCustomerEmail">
                        </div>
                        <div class="form-group">
                            <label>Customer's Phone Number</label>
                            <input type="number" class="form-control" id="editCustomerPhone">
                        </div>
                        <div class="form-group">
                            <label>Customer's Points</label>
                            <input type="number" class="form-control" id="editCustomerPoints">
                        </div>
                        
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button class="btn btn-success" id="saveEditBtn">Save Changes</button>
                    </div>
                    </div>
                </div>
            </div>

    </body>

    <script>
        fetch('nav.html')
        .then(res => res.text())
        .then(html => {
            document.getElementById('sidebar').innerHTML = html;
            document.body.style.visibility = 'visible';
        })
    </script>
     <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        // edit modal js
        document.addEventListener('DOMContentLoaded', () => {
            // Set up edit button event listeners
            const editButtons = document.querySelectorAll('.edit-btn');
            let activeRow = null; // to remember which row we're editing

            editButtons.forEach(btn => {
            btn.addEventListener('click', function () {
                const row = this.closest('tr');
                activeRow = row;

                const customerName = row.children[1].textContent.trim();
                const customerEmail = row.children[2].textContent.trim();
                const customerPhone = row.children[3].textContent.trim();
                const customerPoints = row.children[4].textContent.trim();
                const customerId = row.children[0].textContent.trim();

                document.getElementById('editCustomerName').value = customerName;
                document.getElementById('editCustomerEmail').value = customerEmail;
                document.getElementById('editCustomerPhone').value = customerPhone;
                document.getElementById('editCustomerPoints').value = customerPoints;
                document.getElementById('customerIdField').value = customerId;

                $('#editCustomerModal').modal('show');
                });
            });

            // Handle Save button
            document.getElementById('saveEditBtn').addEventListener('click', () => {
            if (!activeRow) return;

            const newName = document.getElementById('editCustomerName').value.trim();
            const newEmail = document.getElementById('editCustomerEmail').value.trim();
            const newPhone = document.getElementById('editCustomerPhone').value.trim();
            const newPoints = document.getElementById('editCustomerPoints').value.trim();
            const newCustId = document.getElementById('editCustomerId').value.trim();

            // Update the actual HTML in the row
            activeRow.children[1].textContent = newName;
            activeRow.children[2].textContent = newEmail;
            activeRow.children[3].textContent = newPhone;
            activeRow.children[4].textContent = newPoints;
            activeRow.children[0].textContent = newCustId;

            // Optionally: add a visual flash or toast here

            $('#editCustomerModal').modal('hide');
            });
        });


        // delete modal js
        document.addEventListener('DOMContentLoaded', function () {
            const deleteButtons = document.querySelectorAll('.delete-btn');

            deleteButtons.forEach(btn => {
            btn.addEventListener('click', function () {
                const row = this.closest('tr');
                const customerId = row.children[0].textContent.trim();
                const customerName = row.children[1].textContent.trim();

                // Set the modal's hidden field and message
                document.getElementById('deleteCustomerId').value = customerId;
                document.getElementById('deleteCustomerText').textContent = 
                `Are you sure you want to delete the customer "${customerName}"?`;

                // Show modal (Bootstrap 4)
                $('#deleteCustomerModal').modal('show');
            });
            });

            document.getElementById('confirmDeleteBtn').addEventListener('click', function () {
                const customerId = document.getElementById('deleteCustomerId').value;
                console.log(`Deleting customer with ID: ${customerId}`);

                // TODO: Add actual delete logic here (fetch backend)
                // For now tangtangon lng ang row sa table:
                const rowToDelete = Array.from(document.querySelectorAll('table tbody tr'))
                    .find(row => row.children[0].textContent.trim() === customerId);

                if (rowToDelete) rowToDelete.remove();

                // close
                $('#deleteCustomerModal').modal('hide');
                });
            });

            
    </script>


                    
</html>