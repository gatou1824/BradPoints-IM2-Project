<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Reports & Feedback - Admin</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="adminStyles.css">
    </head>
    <body>
        <div class="d-flex">
            <div id="sidebar" class="custom-red-card"></div>
            <div class="main-content flex-grow-1 ml-3 container">
                <div class="container mt-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2>Incentives & Rewards Management</h2>
                    <button class="btn btn-success" data-toggle="modal" data-target="#addRewardModal">Add New Reward</button>
                </div>

                <!-- Search & Filter -->
                <div class="row mb-3">
                    <div class="col-md-6">
                    <input type="text" class="form-control" placeholder="Search rewards...">
                    </div>
                    <div class="col-md-3">
                    <select class="form-control">
                        <option selected>Filter</option>
                        <option>Points Required</option>
                        <option>Date Added</option>
                        <option># of Redemptions</option>
                    </select>
                    </div>
                    <div class="col-md-3 text-right">
                    <button class="btn btn-outline-secondary">Apply Filters</button>
                    </div>
                </div>

                <table class="table table-hover">
                    <thead class="thead-red">
                        <tr>
                            <th>#</th>
                            <th>Reward Name</th>
                            <th>Reward Image</th>
                            <th>Points Required</th>
                            <th>Date Added</th>
                            <th># of Redemptions</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody class="text-center">

                        <tr>
                            <td>1</td>
                            <td>Free Cheeseburger</td>
                            <td><img src="images/burger.jpg" class="img-fluid" style="max-width: 100px; height: auto;"></td>
                            <td>18</td>
                            <td>2025-08-01</td>
                            <td>457</td>
                            <td>
                            <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                            <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Free Siomai</td>
                            <td><img src="images/siomai.png" class="img-fluid" style="max-width: 100px; height: auto;"></td>
                            <td>6</td>
                            <td>2025-07-20</td>
                            <td>457</td>
                            <td>
                            <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                            <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                            </td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Free Steamed Rice</td>
                            <td><img src="images/steamrice.png" class="img-fluid" style="max-width: 100px; height: auto;"></td>
                            <td>15</td>
                            <td>2025-06-01</td>
                            <td>457</td>
                            <td>
                            <button class="btn btn-sm btn-primary edit-btn">Edit</button>
                            <button class="btn btn-sm btn-danger delete-btn">Delete</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
                </div>


                <div class="row">
                    <div class="col-md-12">
                        <div class="quick-actions">
                            <h3>Quick Actions</h3>
                            <button class="btn btn-primary" onclick="location.href='custmgt.html'">Add New Customer</button>
                            <button class="btn btn-secondary" onclick="location.href='reports.html'">View Latest Feedback</button>
                            <button class="btn btn-success">Add Pending Action</button>
                        </div>
                    </div>
                </div>    
            </div>
     
        </div>

        <!-- Modal Divs Below -->
            <!-- add reward modal -->
            <div class="modal fade" id="addRewardModal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Add New Reward</h5>
                            <button type="button" class="close" data-dismiss="modal">
                                <span>&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="form-group">
                                    <label>Reward Name</label>
                                    <input type="text" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label>Image</label>
                                    <input type="file" class="form-control-file">
                                </div>
                                <div class="form-group">
                                    <label>Points Required</label>
                                    <input type="number" class="form-control" required>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-success">Save Reward</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- edit reward modal -->
            <div class="modal fade" id="editRewardModal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Edit Reward</h5>
                        <button type="button" class="close" data-dismiss="modal">
                        <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="editRewardForm">
                        <input type="hidden" id="rewardIdField">
                        <div class="form-group">
                            <label>Reward Name</label>
                            <input type="text" class="form-control" id="editRewardName">
                        </div>
                        <div class="form-group">
                            <label>Points Required</label>
                            <input type="number" class="form-control" id="editRewardPoints">
                        </div>
                        <div class="form-group">
                            <label>Image</label>
                            <input type="file" class="form-control-file">
                        </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button class="btn btn-success" id="saveEditBtn">Save Changes</button>
                    </div>
                    </div>
                </div>
            </div>

            <!-- delete reward modal -->
             <div class="modal fade" id="deleteRewardModal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title">Confirm Delete</h5>
                        <button type="button" class="close text-white" data-dismiss="modal">
                        <span>&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p id="deleteRewardText">Are you sure you want to delete this reward?</p>
                        <input type="hidden" id="deleteRewardId">
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                    </div>
                    </div>
                </div>
            </div>
    </body>

    <script>
        fetch('nav.html')
        .then(res => res.text())
        .then(html => {
            document.getElementById('sidebar').innerHTML = html;
            document.body.style.visibility = 'visible';
        })
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Set up edit button event listeners
            const editButtons = document.querySelectorAll('.edit-btn');
            let activeRow = null; // to remember which row we're editing

            editButtons.forEach(btn => {
            btn.addEventListener('click', function () {
                const row = this.closest('tr');
                activeRow = row;

                const rewardName = row.children[1].textContent.trim();
                const points = row.children[3].textContent.trim();
                const rewardId = row.children[0].textContent.trim();

                document.getElementById('editRewardName').value = rewardName;
                document.getElementById('editRewardPoints').value = points;
                document.getElementById('rewardIdField').value = rewardId;

                $('#editRewardModal').modal('show');
            });
            });

            // Handle Save button
            document.getElementById('saveEditBtn').addEventListener('click', () => {
            if (!activeRow) return;

            const newName = document.getElementById('editRewardName').value.trim();
            const newPoints = document.getElementById('editRewardPoints').value.trim();

            // Update the actual HTML in the row
            activeRow.children[1].textContent = newName;
            activeRow.children[3].textContent = newPoints;

            // Optionally: add a visual flash or toast here

            $('#editRewardModal').modal('hide');
            });
        });

        // delete modal js
        document.addEventListener('DOMContentLoaded', function () {
            const deleteButtons = document.querySelectorAll('.delete-btn');

            deleteButtons.forEach(btn => {
            btn.addEventListener('click', function () {
                const row = this.closest('tr');
                const rewardId = row.children[0].textContent.trim();
                const rewardName = row.children[1].textContent.trim();

                // Set the modal's hidden field and message
                document.getElementById('deleteRewardId').value = rewardId;
                document.getElementById('deleteRewardText').textContent = 
                `Are you sure you want to delete the reward "${rewardName}"?`;

                // Show modal (Bootstrap 4)
                $('#deleteRewardModal').modal('show');
            });
            });

            document.getElementById('confirmDeleteBtn').addEventListener('click', function () {
                const rewardId = document.getElementById('deleteRewardId').value;
                console.log(`Deleting reward with ID: ${rewardId}`);

                // TODO: Add actual delete logic here (fetch backend)
                // For now tangtangon lng ang row sa table:
                const rowToDelete = Array.from(document.querySelectorAll('table tbody tr'))
                    .find(row => row.children[0].textContent.trim() === rewardId);

                if (rowToDelete) rowToDelete.remove();

                // close
                $('#deleteRewardModal').modal('hide');
                });
            });
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

                    
</html>